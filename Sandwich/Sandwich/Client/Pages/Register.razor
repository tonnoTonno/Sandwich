@page "/register"
@using System.Net.Http.Headers
@inject HttpClient Http

<html>
<head>
    <title>Register Page</title>
    <style>
        h1{
            font-size:150px;
            color:floralwhite;
            font-family:'Calisto MT';
            font-weight:100;
            text-align:center;
            
        }

        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
        }

        .register-container {
            width: 500px;
            margin: 100px auto;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .register-header {
            padding: 20px;
            background-color: #333;
            color: #fff;
        }

            .register-header h1 {
                margin: 0;
                font-size: 32px;
            }

        .register-form {
            padding: 20px;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
            border: none;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

            .form-control:focus {
                outline: none;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: none;
            background-color: #333;
            color: #fff;
            font-size: 18px;
            cursor: pointer;
        }

        .submit-btn:hover {
            background-color: #555;
        }

        body {
            /*background-image: url("https://drive.google.com/uc?export=view&id=129PZL-etxrZkadR4sAjRTQ5mPMmIY1E5");*/

            background-color: #2b468b;
        }

        #error {
            position: relative;
            animation: shake .1s linear;
            animation-iteration-count: 5;
            border: solid red;
        } 
        
        @@keyframes shake {
              0% { margin-left: 0rem; }
              25% { margin-left: 0.5rem; }
              75% { margin-left: -0.5rem; }
              100% { margin-left: 0rem; }
        }

    </style>
</head>
<body>
    <h1>Sandwitch quiz</h1>
    <div class="register-container">
        <div class="register-header">
            <div class="input-group">
                <h1>Welcome!</h1>
                <span class="input-group-btn" style="width:230px;"></span>
                <p>or</p>
                <span class="input-group-btn" style="width:7px;"></span>
                <a href="login"> Login</a>
            </div>
        </div>
        <div class="register-form">
            <form>

                <div class="input-group">
                    <input type="text" class="form-control input-sm" placeholder="Name" id="@NamErrore" @oninput="@((e) => { Name=(string)e.Value;})" @onchange="@((ChangeEventArgs e) =>{ Name = e.Value.ToString(); NamErrore=null;})" />
                    <span class="input-group-btn" style="width:10px;"></span>
                    <input type="text" class="form-control input-sm" placeholder="Surname" id="@NamErrore" @oninput="@((e) => { Surname=(string)e.Value;})" @onchange="@((ChangeEventArgs e) =>{ Surname = e.Value.ToString(); NamErrore=null;})" />
                </div>
                <input type="text" class="form-control" placeholder="Username" id="@UserErrore" @oninput="@((e) => { _Username=(string)e.Value;})" @onchange="@((ChangeEventArgs e) =>{ _Username = e.Value.ToString(); UserErrore=null;})">
                <input type="email" class="form-control" placeholder="Email" id="@MailErrore" @oninput="@((e) => { _Mail=(string)e.Value;})" @onchange="@((ChangeEventArgs e) =>{ _Mail = e.Value.ToString(); MailErrore=null;})">
                <input type="password" class="form-control" placeholder="Password" id="@PswErrore" value="@_Password" @onchange="@((ChangeEventArgs e) =>{ _Password = e.Value.ToString(); PswErrore=null;})" @oninput="@((e) => { _Password=(string)e.Value;})" >
                <input type="password" class="form-control" placeholder="Confirm Password" id="@PswErrore" @onchange="@((ChangeEventArgs e) =>{ Confirm = e.Value.ToString(); PswErrore=null;})" @oninput="@((e) => { Confirm=(string)e.Value;})">
                <button type="button" class="submit-btn" @onclick="Registra">Register</button>  
                <button type="button" class="submit-btn" @onclick="Check">Check</button>
            </form>
        </div>
    </div>
</body>
</html>
@code {
    public string Name { get; set; } = "";
    public string Surname { get; set; } = "";
    public string _Username { get; set; } = "";
    public string _Mail { get; set; } = "";
    public string _Password { get; set; } = "";
    public string Confirm { get; set; } = "";

    public string PswErrore { get; set; }
    public string NamErrore{ get; set; }
    public string MailErrore { get; set; }
    public string UserErrore { get; set; }

    public void Check()
    {
        Console.WriteLine($"Name={Name}\nSurname={Surname}\nUsername={_Username}\nMail={_Mail}\nPassword={_Password}\nConfirm={Confirm}\nPswErrore={PswErrore}\nNamErrore={NamErrore}\nMailErrore={MailErrore}\nUserErrore={UserErrore}\n");
    }

    public async Task Registra()
    {
        if (_Password == Confirm && Name != "" && Surname != "" && _Username != "" && _Mail != "" && _Password != "")
        {
            Utente utente = new Utente { Mail = _Mail, Nome = Name, Cognome = Surname, Username = _Username, Password = _Password };
            string apiurl = "/api/Utente";
            HttpResponseMessage response = await Http.PostAsJsonAsync(apiurl, utente);
        }
        else
        {
            if (Name == "" || _Username == "")
                    NamErrore = "error";
            if (_Username == "")
                    UserErrore = "error";
            if (_Mail == "")
                    MailErrore = "error";
            if (_Password != Confirm || _Password == "")
                    PswErrore = "error";
            }
    }
}
